#include <iostream>
#include <string>
#include <iomanip>
using namespace std;

class Cuenta {
protected:
    string numeroCuenta;
    string propietario;
    double saldo;

public:
    Cuenta(string num, string prop, double sal) 
        : numeroCuenta(num), propietario(prop), saldo(sal >= 0 ? sal : 0) {}
    
    virtual ~Cuenta() {}
     // Métodos virtuales
    virtual void depositar(double monto) {
        if(monto > 0) {
            saldo += monto;
            cout << "Depósito exitoso: $" << monto << endl;
        }
    }
    
    virtual void retirar(double monto) {
        if(monto > 0 && monto <= saldo) {
            saldo -= monto;
            cout << "Retiro exitoso: $" << monto << endl;
        } else {
            cout << "Error en retiro" << endl;
        }
    }
    
    virtual void mostrarInfo() {
        cout << "Cuenta: " << numeroCuenta << " - " << propietario 
             << " - Saldo: $" << fixed << setprecision(2) << saldo << endl;
    }
    
    double getSaldo() const { return saldo; }
};

class CuentaAhorro : public Cuenta {
private:
    double tasaInteres;

public:
    CuentaAhorro(string num, string prop, double sal, double tasa)
        : Cuenta(num, prop, sal), tasaInteres(tasa >= 0 ? tasa : 0) {}
    
    void generarInteres() {
        double interes = saldo * tasaInteres;
        saldo += interes;
        cout << "Interés generado: $" << interes << endl;
    }
    
    void mostrarInfo() override {
        cout << "AHORRO - ";
        Cuenta::mostrarInfo();
        cout << "Tasa: " << (tasaInteres * 100) << "%" << endl;
    }
};
class CuentaCorriente : public Cuenta {
private:
    double limiteDescubierto;

public:
    CuentaCorriente(string num, string prop, double sal, double limite)
        : Cuenta(num, prop, sal), limiteDescubierto(limite >= 0 ? limite : 0) {}
    
    void retirar(double monto) override {
        if(monto > 0 && monto <= (saldo + limiteDescubierto)) {
            saldo -= monto;
            cout << "Retiro exitoso: $" << monto << endl;
            if(saldo < 0) cout << "Descubierto: $" << -saldo << endl;
        } else {
            cout << "Límite excedido" << endl;
        }
    }
    
    void mostrarInfo() override {
        cout << "CORRIENTE - ";
        Cuenta::mostrarInfo();
        cout << "Límite: $" << limiteDescubierto << endl;
    }
};

void mostrarMenuCuenta(Cuenta* cuenta, bool esAhorro) {
    int opcion;
    
    do {
        cout << "\n--- OPERACIONES ---" << endl;
        cout << "1. Depositar" << endl;
        cout << "2. Retirar" << endl;
        if(esAhorro) {
            cout << "3. Generar interés" << endl;
            cout << "4. Mostrar información" << endl;
            cout << "5. Salir" << endl;
        } else {
            cout << "3. Mostrar información" << endl;
            cout << "4. Salir" << endl;
        }
        cout << "Opción: ";
        cin >> opcion;
        
        double monto;
        switch(opcion) {
            case 1:
                cout << "Monto: $"; cin >> monto;
                cuenta->depositar(monto);
                break;
            case 2:
                cout << "Monto: $"; cin >> monto;
                cuenta->retirar(monto);
                break;
            case 3:
                if(esAhorro) {
                    dynamic_cast<CuentaAhorro*>(cuenta)->generarInteres();
                } else {
                    cuenta->mostrarInfo();
                }
                break;
            case 4:
                if(esAhorro) {
                    cuenta->mostrarInfo();
                } else {
                    return;
                }
                break;
            case 5:
                if(esAhorro) return;
        }
    } while(true);
}
int main() {
    cout << "=== SISTEMA BANCARIO ===" << endl;
    cout << "1. Cuenta Ahorro\n2. Cuenta Corriente\nOpción: ";
    
    int opcion;
    cin >> opcion;
    cin.ignore();
    
    string num, prop;
    double saldo, extra;
    
    cout << "Número cuenta: "; getline(cin, num);
    cout << "Propietario: "; getline(cin, prop);
    cout << "Saldo inicial: $"; cin >> saldo;
    
    Cuenta* cuenta;
    
    if(opcion == 1) {
        cout << "Tasa interés: "; cin >> extra;
        cuenta = new CuentaAhorro(num, prop, saldo, extra);
        mostrarMenuCuenta(cuenta, true);
    } else {
        cout << "Límite descubierto: $"; cin >> extra;
        cuenta = new CuentaCorriente(num, prop, saldo, extra);
        mostrarMenuCuenta(cuenta, false);
    }
     delete cuenta;
    cout << "\n¡Gracias!" << endl;
    return 0;
}
